# RePlay
В библиотеке RePlay реализовано множество алгоритмов для создания моделей рекомендательных систем. \
Инструменты библиотеки позволяют запускать сценарии для автоматического подбора гиперпараметров модели и обучения лучшей модели исходя из заданных метрик. \
Кроме того, в RePlay можно проводить эксперименты по сравнению обученных моделей по выбранным метрикам и времени работы.  

### Алгоритмы, реализованные в RePlay
* Popular Recommender
* Wilson Recommender
* Random Recommender
* K-Nearest Neighbours
* Classifier Recommender
* Alternating Least Squares
* Neural Matrix Factorization
* SLIM
* ADMM SLIM
* Mult-VAE
* Word2Vec Recommender
* Обертка LightFM
* Обертка implicit

Больше информации об алгоритмах - в документации к replay.

### Метрики
В библиотеке реализованы основные метрики для оценки качества рекомендательных систем, такие как **HitRate, Precision, MAP, Recall, ROC-AUC, MRR, NDCG, Surprisal, Unexpectedness, Coverage**. Кроме того пользователь может создать свою метрику.
Все метрики рассчитываются для первых K объектов в рекомендации.

### Сценарии 
Функциональность библиотеки позволяет запускать сценарии, объединяющие в себе основные этапы создания рекомендательной системы:
* разбиение данных сплиттером на обучающую и валидационную выборки
* автоматический подбор гипер-параметров
* расчёт метрик качества для полученных моделей-кандидатов
* обучение на всём объёме данных с подобранными гипер-параметрами и отгрузка рекомендаций (batch production)

### Эксперименты
Библиотека позволяет сравнить обученные модели по заданным метрикам и времени работы с использованием класса Experiment, обеспечивающего подсчет метрик и хранение результатов сравнения.

### Дополнительные инструменты
В RePlay реализованы инструменты для предобработки данных, фильтрации, преобразования в формат библиотеки и разбиения на тренировочную и тестовую выборки несколькими способами. 

## Как начать пользоваться библиотекой

### Установка
Для корректной работы используйте python 3.6+ и java 8+. \
Клонируйте репозиторий и установите библиотеку:
```bash
git clone https://sbtatlas.sigma.sbrf.ru/stash/scm/ailab/replay.git
cd replay
pip install poetry
poetry install
```

### Проверка работы библиотеки
Запустите тесты для проверки корректность установки. \
Из директории `replay`:
```bash
pytest ./tests
```

### Документация
Документацию можно сформировать самостоятельно после установки пакета.\
Из директории `replay`:
```bash
cd ./docs
mkdir -p _static
make clean html
```
Документация будет доступна в `replay/docs/_build/html/index.html`


## Как присоединиться к разработке
Для удобства проверки кода используейте тестирующий скрипт test_package.sh.
Для этого в директории с библиотекой должна быть создана виртуальная среда python с именем venv, и библиотека должна быть установлена в ней. 
Создайте виртуальную среду перед установкой библиотеки.\
Из директории `replay`:
```bash
python3 -m venv .
source ./bin/activate
```
Установите библиотеку по инструкции для пользователей.

### Проверка работы библиотеки после доработки
Запустите тестирующий скрипт `test_package.sh`, который сформирует документацию, проверит код pylint, pycodestyle и запустит тесты.
Для корректной работы скрипта в директории `replay` должна быть создана виртуальная среда venv.
```bash
./test_package.sh
```

### Проверка качества кода
Настройте pre-commit hooks для автоматического форматирования и проверки кода.\
Из директории `replay`:
```bash
pre-commit install
```
