## Выбор алгоритма

**Особенности данных и алгоритмы**
Чтобы выбрать алгоритм, нужно понять, к какому типу относятся данные для обучения, и насколько изменчив состав пользователей и объектов.  
- _Тип входных данных._ В качестве входных данных модели используют историю взаимодействия пользователей и объектов (коллаборативная информация) и информацию о признаках пользователей, объектов и контектста.
Использование признаковых описаний может улучшить качество рекомендаций по сравнению с решениями, использующими только историю взаимодействия, а также помочь с "холодным стартом" (рекомендациями для пользователей и объектов, отсутствующих в истории взаимодействия).
По типу используемых данных алгоритмы в RePlay делятся на:
    - Collaborative, коллаборативные. Используют историю взаимодействия пользователей и объектов для построения рекомендаций на основании сходства пользователей и объектов. 
    - Content-based. Используют признаковые описания пользователей и объектов для построения рекомендаций.
    - Hybrid, гибридные. Могут использовать коллаборативную информацию, признаки пользователя, объекта и контекста. К гибридным системам также относят ансамбли моделей.
- _Тип взаимодействия._ История взаимодействия может отражать явные предпочтения пользователя, например, оценки (explicit feedback), или неявные предпочтения, например, факт просмотра, количество прослушиваний(implicit feedback). 
    Explicit feedback может содержать информацию об отрицательных взаимодействиях, тогда как implicit feedback рассматривается как индикатор положительного взаимодействия. Так как implicit feedback легче собрать, и его объем больше, многие алгоритмы рекомендательных систем ориентированы именно на работу с implicit feedback.
    Некоторые алгоритмы RePlay игнорируют значения релевантности, переданные пользователем, и используют пары пользователь-объект из лога как одинаково релевантные взаимодействия (unary ratings). Для таких алгоритмов стоит удалить из обучающей выборки взаимодействия, которые нельзя считать положительными.
- _Постоянство пользователей._
 Некоторые алгоритмы требуют переобучения модели, чтобы рекомендовать пользователям, отсутствующим в обучающей выборке (столбец "Рекомендует для новых пользователей"). 
- _Постоянство объектов._
 Большинство алгоритмов требуют переобучения модели, чтобы рекомендовать объекты, отсутствующие в обучающей выборке (столбец "Рекомендует новые объекты").

| Алгоритм       | Тип данных          | Тип взаимодействия | Рекомендует для новых пользователей | Рекомендует новые объекты |
| ---------------|--------------|-------|-------|-------|
|Popular Recommender        |Collaborative    | приводятся к unary ratings             | + | - |
|Popular By Users           |Collaborative    | implicit feedback                      | - | - |
|Wilson Recommender         |Collaborative    | binary ratings                         | + | - |
|Random Recommender         |Collaborative    | приводятся к unary ratings             | + | + |
|K-Nearest Neighbours       |Collaborative    | приводятся к unary ratings             | + | - |
|Classifier Recommender     |Content-based    | binary ratings                         | + | + |
|Alternating Least Squares  |Collaborative    | implicit feedback                      | - | - |
|Neural Matrix Factorization|Collaborative    | приводятся к unary ratings             | - | - |
|SLIM                       |Collaborative    | unary ratings, explicit feedback       | + | - |
|ADMM SLIM                  |Collaborative    | unary ratings, explicit feedback       | + | - |
|Mult-VAE                   |Collaborative    | приводятся к unary ratings             | + | - |
|Word2Vec Recommender       |Collaborative    | приводятся к unary ratings             | + | - |
|Обертка LightFM            |Hybrid           | [в зависимости от типа loss](https://making.lyst.com/lightfm/docs/lightfm.html#lightfm)       | + | + |
|Обертка Implicit           |Collaborative    | [в зависимости от выбранной модели](https://implicit.readthedocs.io/en/latest/index.html)    | - | - |
|Stack Recommender          |Hybrid           | `*`  | `*` | `*` |
|Двухуровневый классификатор|Hybrid           | приводятся к unary ratings для модели второго уровня    | `*` | `*` |

`*` - зависит от алгоритмов, используемых в качестве базовых. 

**Требования к рекомендациям и алгоритмы**
Перед выбором алгоритма стоит оценить, какие рекомендации мы ожидаем получить. 
* _Персонализированность рекомендаций._ Иногда достаточно рекомендовать новые и популярные объекты всем пользователям, но чаще рекомендации должны быть персоналазированными, то есть определяться профилем пользователя и его историей.  
* _Рекомендации для холодных пользователей_ (пользователи, которые не взаимодействовали с объектами)
* _Рекомендации для холодных объектов_ (объекты, для которых отсутствует история взаимодействия с пользователями)
* _Рекомендации новых для пользователя объектов._ Иногда достаточно порекомендовать пользователю какие-то объекты 
из его же истории взаимодействия. Хороший бейзлайн - рекомендации самого популярного из истории пользователя, но в классическом подходе от рекомендательной системы требуется рекомендация объектов, с которыми пользователь еще не взаимодействовал.

| Алгоритм       | Персонализированные | Холодные пользователи | Холодные объекты |  Новые объекты для пользователя |
| ---------------|--------------|-------|-------|-------|
|Popular Recommender          | - | + | - | + |
|Popular By Users             | + | - | - | - |
|Wilson Recommender           | - | + | - | + |
|Random Recommender           | - | + | + | + |
|K-Nearest Neighbours         | + | + | - | + |
|Classifier Recommender       | + | + | + | + |
|Alternating Least Squares    | + | - | - | + |
|Neural Matrix Factorization  | + | - | - | + |
|SLIM                         | + | - | - | + |
|ADMM SLIM                    | + | - | - | + |
|Mult-VAE                     | + | - | - | + |
|Word2Vec Recommender         | + | - | - | + |
|Обертка LightFM              | + | + | + | + |
|Обертка Implicit             | + | - | - | + |
|Stack Recommender            | + | `*` | `*` | `*` |
|Двухуровневый классификатор  | + | `*` | `*` | `*` |

`*` - зависит от алгоритмов, используемых в качестве базовых.

Больше информации об алгоритмах - в [документации](../modules/models).
